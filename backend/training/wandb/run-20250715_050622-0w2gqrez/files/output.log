Using device: cuda
Classes: ['anthracnose', 'gumosis', 'healthy', 'leaf_miner', 'red_rust']
Train dataset size: 18910
Validation dataset size: 6901
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:286: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()

Epoch 1/50
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/394, Loss: 1.6270
Batch 100/394, Loss: 0.1555
Batch 200/394, Loss: 0.1282
Batch 300/394, Loss: 0.0601
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.2833, Train Acc: 91.18%
Val Loss: 0.1917, Val Acc: 93.58%
Model saved as ONNX: models/best_cashew_model.onnx

Best validation accuracy: 93.58%
Classification Report:
              precision    recall  f1-score   support

 anthracnose       0.92      0.87      0.89      1838
     gumosis       0.99      1.00      1.00       425
     healthy       0.90      0.99      0.94      1336
  leaf_miner       0.95      0.90      0.92      1487
    red_rust       0.96      0.99      0.97      1815

    accuracy                           0.94      6901
   macro avg       0.94      0.95      0.94      6901
weighted avg       0.94      0.94      0.94      6901


Epoch 2/50
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/394, Loss: 0.0126
Batch 100/394, Loss: 0.0909
Batch 200/394, Loss: 0.0367
Batch 300/394, Loss: 0.2332
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0734, Train Acc: 97.76%
Val Loss: 0.2096, Val Acc: 94.22%
Model saved as ONNX: models/best_cashew_model.onnx

Best validation accuracy: 94.22%
Classification Report:
              precision    recall  f1-score   support

 anthracnose       0.95      0.86      0.90      1838
     gumosis       1.00      1.00      1.00       425
     healthy       0.90      1.00      0.95      1336
  leaf_miner       0.92      0.94      0.93      1487
    red_rust       0.97      0.98      0.98      1815

    accuracy                           0.94      6901
   macro avg       0.95      0.95      0.95      6901
weighted avg       0.94      0.94      0.94      6901


Epoch 3/50
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/394, Loss: 0.0287
Batch 100/394, Loss: 0.0058
Batch 200/394, Loss: 0.0803
Batch 300/394, Loss: 0.1052
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0389, Train Acc: 98.78%
Val Loss: 0.1970, Val Acc: 94.41%
Model saved as ONNX: models/best_cashew_model.onnx

Best validation accuracy: 94.41%
Classification Report:
              precision    recall  f1-score   support

 anthracnose       0.96      0.86      0.91      1838
     gumosis       1.00      1.00      1.00       425
     healthy       0.91      0.99      0.95      1336
  leaf_miner       0.93      0.94      0.94      1487
    red_rust       0.95      0.99      0.97      1815

    accuracy                           0.94      6901
   macro avg       0.95      0.95      0.95      6901
weighted avg       0.94      0.94      0.94      6901


Epoch 4/50
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/394, Loss: 0.0084
Batch 100/394, Loss: 0.0200
Batch 200/394, Loss: 0.0106
Batch 300/394, Loss: 0.0109
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0234, Train Acc: 99.26%
Val Loss: 0.2373, Val Acc: 94.17%

Epoch 5/50
--------------------------------------------------
Batch 0/394, Loss: 0.0097
Batch 100/394, Loss: 0.0085
Batch 200/394, Loss: 0.1133
Batch 300/394, Loss: 0.0689
Train Loss: 0.0210, Train Acc: 99.35%
Val Loss: 0.1951, Val Acc: 95.25%
Model saved as ONNX: models/best_cashew_model.onnx

Best validation accuracy: 95.25%
Classification Report:
              precision    recall  f1-score   support

 anthracnose       0.95      0.90      0.92      1838
     gumosis       1.00      1.00      1.00       425
     healthy       0.94      0.99      0.96      1336
  leaf_miner       0.93      0.95      0.94      1487
    red_rust       0.98      0.98      0.98      1815

    accuracy                           0.95      6901
   macro avg       0.96      0.96      0.96      6901
weighted avg       0.95      0.95      0.95      6901


Epoch 6/50
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/394, Loss: 0.0020
Batch 100/394, Loss: 0.0018
Batch 200/394, Loss: 0.0009
Batch 300/394, Loss: 0.0368
/root/Crop-Classifier/Crop-Classifier/train_cashew.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0138, Train Acc: 99.53%
Val Loss: 0.2409, Val Acc: 94.78%

Epoch 7/50
--------------------------------------------------
Batch 0/394, Loss: 0.0006
Batch 100/394, Loss: 0.0502
Batch 200/394, Loss: 0.0030
Batch 300/394, Loss: 0.0177
Train Loss: 0.0156, Train Acc: 99.52%
Val Loss: 0.2567, Val Acc: 94.29%

Epoch 8/50
--------------------------------------------------
Batch 0/394, Loss: 0.0132
Batch 100/394, Loss: 0.0470
Batch 200/394, Loss: 0.0014
Batch 300/394, Loss: 0.0322
Train Loss: 0.0065, Train Acc: 99.83%
Val Loss: 0.2528, Val Acc: 94.84%

Epoch 9/50
--------------------------------------------------
Batch 0/394, Loss: 0.0003
Batch 100/394, Loss: 0.0145
Batch 200/394, Loss: 0.0006
Batch 300/394, Loss: 0.0001
Train Loss: 0.0034, Train Acc: 99.90%
Val Loss: 0.2628, Val Acc: 94.67%

Epoch 10/50
--------------------------------------------------
Batch 0/394, Loss: 0.0001
Batch 100/394, Loss: 0.0013
Batch 200/394, Loss: 0.0011
Batch 300/394, Loss: 0.0001
Train Loss: 0.0044, Train Acc: 99.88%
Val Loss: 0.2727, Val Acc: 94.42%

Epoch 11/50
--------------------------------------------------
Batch 0/394, Loss: 0.0000
Batch 100/394, Loss: 0.0038
Batch 200/394, Loss: 0.0001
Batch 300/394, Loss: 0.0001
Train Loss: 0.0029, Train Acc: 99.90%
Val Loss: 0.2598, Val Acc: 94.65%

Epoch 12/50
--------------------------------------------------
Batch 0/394, Loss: 0.0001
Batch 100/394, Loss: 0.0007
Batch 200/394, Loss: 0.0013
Batch 300/394, Loss: 0.0000
Train Loss: 0.0035, Train Acc: 99.87%
Val Loss: 0.2689, Val Acc: 94.68%

Epoch 13/50
--------------------------------------------------
Batch 0/394, Loss: 0.0009
Batch 100/394, Loss: 0.0001
Batch 200/394, Loss: 0.0001
Batch 300/394, Loss: 0.0001
Train Loss: 0.0026, Train Acc: 99.93%
Val Loss: 0.3090, Val Acc: 94.46%

Epoch 14/50
--------------------------------------------------
Batch 0/394, Loss: 0.0001
Batch 100/394, Loss: 0.0000
Batch 200/394, Loss: 0.0030
Batch 300/394, Loss: 0.0000
Train Loss: 0.0020, Train Acc: 99.94%
Val Loss: 0.2451, Val Acc: 95.13%

Epoch 15/50
--------------------------------------------------
Batch 0/394, Loss: 0.0002
Batch 100/394, Loss: 0.0002
Batch 200/394, Loss: 0.0002
Batch 300/394, Loss: 0.0001
Train Loss: 0.0013, Train Acc: 99.97%
Val Loss: 0.2681, Val Acc: 94.88%
Early stopping triggered after 10 epochs without improvement

Training completed! Best validation accuracy: 95.25%
