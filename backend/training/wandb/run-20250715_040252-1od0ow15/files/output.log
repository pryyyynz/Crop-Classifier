Using device: cuda
Classes: ['bacterial_blight', 'brown_spot', 'green_mite', 'healthy', 'mosaic']
Train dataset size: 16971
Validation dataset size: 7510
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:286: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()

Epoch 1/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 1.5861
Batch 100/531, Loss: 0.3054
Batch 200/531, Loss: 0.7355
Batch 300/531, Loss: 0.1342
Batch 400/531, Loss: 0.4875
Batch 500/531, Loss: 0.1797
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.3992, Train Acc: 85.94%
Val Loss: 0.2312, Val Acc: 92.17%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 92.17%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.92      0.92      0.92      2623
      brown_spot       0.94      0.87      0.90      1483
      green_mite       0.83      0.95      0.89      1020
         healthy       0.94      0.97      0.95      1184
          mosaic       0.98      0.91      0.94      1200

        accuracy                           0.92      7510
       macro avg       0.92      0.92      0.92      7510
    weighted avg       0.92      0.92      0.92      7510


Epoch 2/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.1716
Batch 100/531, Loss: 0.1985
Batch 200/531, Loss: 0.0384
Batch 300/531, Loss: 0.1748
Batch 400/531, Loss: 0.0563
Batch 500/531, Loss: 0.1006
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.1447, Train Acc: 94.96%
Val Loss: 0.1668, Val Acc: 94.55%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 94.55%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.96      0.93      0.94      2623
      brown_spot       0.92      0.95      0.93      1483
      green_mite       0.88      0.96      0.92      1020
         healthy       0.97      0.96      0.97      1184
          mosaic       0.98      0.95      0.96      1200

        accuracy                           0.95      7510
       macro avg       0.94      0.95      0.95      7510
    weighted avg       0.95      0.95      0.95      7510


Epoch 3/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.0737
Batch 100/531, Loss: 0.0428
Batch 200/531, Loss: 0.0169
Batch 300/531, Loss: 0.2269
Batch 400/531, Loss: 0.1200
Batch 500/531, Loss: 0.0169
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0820, Train Acc: 97.32%
Val Loss: 0.1818, Val Acc: 95.01%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 95.01%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.95      0.95      0.95      2623
      brown_spot       0.96      0.91      0.93      1483
      green_mite       0.88      0.98      0.93      1020
         healthy       0.98      0.97      0.97      1184
          mosaic       0.98      0.96      0.97      1200

        accuracy                           0.95      7510
       macro avg       0.95      0.95      0.95      7510
    weighted avg       0.95      0.95      0.95      7510


Epoch 4/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.0147
Batch 100/531, Loss: 0.0113
Batch 200/531, Loss: 0.1283
Batch 300/531, Loss: 0.1065
Batch 400/531, Loss: 0.0638
Batch 500/531, Loss: 0.0099
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0597, Train Acc: 98.04%
Val Loss: 0.1903, Val Acc: 94.41%

Epoch 5/20
--------------------------------------------------
Batch 0/531, Loss: 0.1714
Batch 100/531, Loss: 0.1313
Batch 200/531, Loss: 0.0060
Batch 300/531, Loss: 0.0427
Batch 400/531, Loss: 0.0532
Batch 500/531, Loss: 0.2599
Train Loss: 0.0442, Train Acc: 98.43%
Val Loss: 0.1920, Val Acc: 95.34%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 95.34%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.97      0.94      0.95      2623
      brown_spot       0.94      0.96      0.95      1483
      green_mite       0.89      0.98      0.93      1020
         healthy       0.97      0.98      0.97      1184
          mosaic       0.99      0.94      0.96      1200

        accuracy                           0.95      7510
       macro avg       0.95      0.96      0.95      7510
    weighted avg       0.95      0.95      0.95      7510


Epoch 6/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.0023
Batch 100/531, Loss: 0.1392
Batch 200/531, Loss: 0.0243
Batch 300/531, Loss: 0.0036
Batch 400/531, Loss: 0.0085
Batch 500/531, Loss: 0.0142
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0419, Train Acc: 98.61%
Val Loss: 0.2685, Val Acc: 94.74%

Epoch 7/20
--------------------------------------------------
Batch 0/531, Loss: 0.0066
Batch 100/531, Loss: 0.0163
Batch 200/531, Loss: 0.0011
Batch 300/531, Loss: 0.0002
Batch 400/531, Loss: 0.0021
Batch 500/531, Loss: 0.0093
Train Loss: 0.0310, Train Acc: 98.95%
Val Loss: 0.2191, Val Acc: 95.23%

Epoch 8/20
--------------------------------------------------
Batch 0/531, Loss: 0.0026
Batch 100/531, Loss: 0.0026
Batch 200/531, Loss: 0.0051
Batch 300/531, Loss: 0.0174
Batch 400/531, Loss: 0.0065
Batch 500/531, Loss: 0.0059
Train Loss: 0.0268, Train Acc: 99.12%
Val Loss: 0.2463, Val Acc: 94.39%

Epoch 9/20
--------------------------------------------------
Batch 0/531, Loss: 0.0106
Batch 100/531, Loss: 0.0183
Batch 200/531, Loss: 0.0012
Batch 300/531, Loss: 0.0006
Batch 400/531, Loss: 0.0054
Batch 500/531, Loss: 0.0095
Train Loss: 0.0153, Train Acc: 99.51%
Val Loss: 0.2242, Val Acc: 95.46%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 95.46%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.96      0.93      0.95      2623
      brown_spot       0.93      0.96      0.94      1483
      green_mite       0.91      0.98      0.94      1020
         healthy       0.98      0.97      0.98      1184
          mosaic       0.98      0.96      0.97      1200

        accuracy                           0.95      7510
       macro avg       0.95      0.96      0.96      7510
    weighted avg       0.96      0.95      0.95      7510


Epoch 10/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.0003
Batch 100/531, Loss: 0.0025
Batch 200/531, Loss: 0.0240
Batch 300/531, Loss: 0.0004
Batch 400/531, Loss: 0.0019
Batch 500/531, Loss: 0.0021
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0119, Train Acc: 99.64%
Val Loss: 0.2239, Val Acc: 95.82%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 95.82%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.95      0.96      0.96      2623
      brown_spot       0.95      0.94      0.94      1483
      green_mite       0.93      0.97      0.95      1020
         healthy       0.98      0.97      0.98      1184
          mosaic       0.98      0.96      0.97      1200

        accuracy                           0.96      7510
       macro avg       0.96      0.96      0.96      7510
    weighted avg       0.96      0.96      0.96      7510


Epoch 11/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.0008
Batch 100/531, Loss: 0.0026
Batch 200/531, Loss: 0.0003
Batch 300/531, Loss: 0.1050
Batch 400/531, Loss: 0.0054
Batch 500/531, Loss: 0.0014
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0076, Train Acc: 99.78%
Val Loss: 0.2241, Val Acc: 96.09%
Model saved as ONNX: models/best_cassava_model.onnx

Best validation accuracy: 96.09%
Classification Report:
                  precision    recall  f1-score   support

bacterial_blight       0.96      0.96      0.96      2623
      brown_spot       0.95      0.94      0.95      1483
      green_mite       0.93      0.98      0.95      1020
         healthy       0.98      0.98      0.98      1184
          mosaic       0.98      0.96      0.97      1200

        accuracy                           0.96      7510
       macro avg       0.96      0.96      0.96      7510
    weighted avg       0.96      0.96      0.96      7510


Epoch 12/20
--------------------------------------------------
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:114: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Batch 0/531, Loss: 0.0007
Batch 100/531, Loss: 0.0003
Batch 200/531, Loss: 0.0012
Batch 300/531, Loss: 0.0017
Batch 400/531, Loss: 0.0162
Batch 500/531, Loss: 0.0002
/root/Crop-Classifier/Crop-Classifier/train_cassava.py:149: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Train Loss: 0.0076, Train Acc: 99.75%
Val Loss: 0.2322, Val Acc: 95.85%

Epoch 13/20
--------------------------------------------------
Batch 0/531, Loss: 0.0006
Batch 100/531, Loss: 0.0017
Batch 200/531, Loss: 0.0040
Batch 300/531, Loss: 0.0247
Batch 400/531, Loss: 0.0018
Batch 500/531, Loss: 0.0014
Train Loss: 0.0111, Train Acc: 99.62%
Val Loss: 0.2535, Val Acc: 95.59%

Epoch 14/20
--------------------------------------------------
Batch 0/531, Loss: 0.0004
Batch 100/531, Loss: 0.0001
Batch 200/531, Loss: 0.0009
Batch 300/531, Loss: 0.0003
Batch 400/531, Loss: 0.0041
Batch 500/531, Loss: 0.0004
Train Loss: 0.0075, Train Acc: 99.72%
Val Loss: 0.2709, Val Acc: 95.49%

Epoch 15/20
--------------------------------------------------
Batch 0/531, Loss: 0.0014
Batch 100/531, Loss: 0.0002
Batch 200/531, Loss: 0.0001
Batch 300/531, Loss: 0.0002
Batch 400/531, Loss: 0.0177
Batch 500/531, Loss: 0.0013
Train Loss: 0.0074, Train Acc: 99.79%
Val Loss: 0.2515, Val Acc: 95.85%

Epoch 16/20
--------------------------------------------------
Batch 0/531, Loss: 0.0002
Batch 100/531, Loss: 0.0324
Batch 200/531, Loss: 0.0001
Batch 300/531, Loss: 0.0001
Batch 400/531, Loss: 0.0002
Batch 500/531, Loss: 0.0003
Train Loss: 0.0030, Train Acc: 99.91%
Val Loss: 0.2407, Val Acc: 95.58%
Early stopping triggered after 5 epochs without improvement

Training completed! Best validation accuracy: 96.09%
